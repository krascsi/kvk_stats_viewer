# KovaaK's Stats Viewer

## Description

A graphical desktop application designed to load, analyze, and visualize your KovaaK's aim trainer performance statistics. It reads the local `.csv` stat files generated by KovaaK's, providing insights into your progress over time for different scenarios.

## Features

* **Stats Folder Selection:** Browse and select your KovaaK's stats folder.
* **Auto-Path Detection:** Attempts to automatically find the default KovaaK's stats directory on Windows, macOS, and Linux.
* **Efficient Data Loading:** Parses KovaaK's `.csv` stat files in parallel for faster loading, especially with a large number of files.
* **Playlist Integration:** Load KovaaK's `.json` playlist files to filter and view scenarios grouped by playlist.
* **Scenario Navigation:** Displays a list of all scenarios found in your stats, filterable by:
    * Search term.
    * Loaded Playlists.
    * Start Date.
* **Statistics Summary:** View key performance indicators for the selected scenario:
    * Personal Best (PB) Score
    * Average Score
    * Average Accuracy (calculated from hits/misses)
    * Total Number of Runs
    * Date First Played
    * Date Last Played
* **Performance Plotting:** Visualize your progress over time for the selected scenario using Matplotlib:
    * Score vs. Time.
    * Accuracy vs. Time (on a secondary Y-axis).
    * Toggle visibility for:
        * Raw score/accuracy data points.
        * Moving averages (with configurable window size).
        * PB score progression line.
* **Modern UI:** Built with CustomTkinter for a themed appearance.
* **Logging:** Detailed logs are generated during data processing and saved to the `logs/` directory.
* **Profiling (Optional):** Built-in cProfile integration for performance analysis, configurable via `src/main.py`. Output saved to `profiles/`.

## Requirements

* Python 3.x
* The following Python Libraries:
    * `customtkinter`
    * `pandas`
    * `numpy`
    * `matplotlib`
* `uv` (Recommended for installation and running) - See [uv installation guide](https://github.com/astral-sh/uv#installation).

## Installation (using uv)

1.  **Install `uv`:** Follow the official [uv installation guide](https://github.com/astral-sh/uv#installation) if you haven't already.
2.  **Clone Repository:** Get the source code.
    ```bash
    git clone <your-repository-url> # Or download the ZIP
    cd kvk-stats-viewer
    ```
3.  **(Optional but Recommended) Create Virtual Environment:** While `uv run` can often manage this, creating it explicitly ensures it exists.
    ```bash
    # Creates a .venv directory by default
    uv venv
    ```
4.  **Install Dependencies:** Use `uv` to install the required libraries into the virtual environment (`.venv` by default).
    ```bash
    uv pip install customtkinter pandas numpy matplotlib
    ```

## Usage

There are two main ways to run the application:

**Method 1: Using `uv run` (Recommended for Simplicity)**

This command attempts to automatically find or create the virtual environment, use the installed packages within it, and execute the script.

1.  Navigate to the project's root directory (`kvk-stats-viewer`).
2.  Execute:
    ```bash
    uv run python src/main.py
    ```

**Method 2: Manual Virtual Environment Activation**

This method is useful if you want to run multiple commands within the activated environment or prefer the traditional approach.

1.  Navigate to the project's root directory.
2.  Activate the virtual environment:
    ```bash
    # Linux/macOS:
    source .venv/bin/activate
    # Windows (Command Prompt/PowerShell):
    # .\.venv\Scripts\activate
    ```
    *(Your terminal prompt should change to indicate the active environment, e.g., `(.venv) ...`)*
3.  Run the Python script directly:
    ```bash
    python src/main.py
    ```
4.  Deactivate the environment when finished (optional):
    ```bash
    deactivate
    ```

---

*After starting the application using either method:*

* **Select Stats Folder:** When the application starts, it will attempt to find your KovaaK's stats folder. If not found, or if you want to use a different folder, click the "Browse Stats Folder" button.
* **Explore:** Use the search bar, load playlists, click scenarios, customize the plot, and filter by date.

## (Alternative) Installation using `venv` + `pip`

If you prefer not to use `uv`, you can use Python's standard tools:

1.  **Clone Repository:** `git clone https://github.com/krascsi/kvk_stats_viewer` and `cd kvk-stats-viewer`.
2.  **Create & Activate `venv`:**
    ```bash
    python -m venv .venv
    source .venv/bin/activate  # Or Windows equivalent
    ```
3.  **Install Dependencies Manually:**
    ```bash
    pip install customtkinter pandas numpy matplotlib
    ```
4.  **Configure `.gitignore`:** Add `.venv/` to your `.gitignore`.
5.  **Run:** Activate the environment (`source .venv/bin/activate`) and then run `python src/main.py`.

## Folder Structure

```
kvk_stats_viewer/
├── src/                  # Source code
│   ├── __init__.py       # Package marker
│   ├── main.py           # Main application entry point
│   ├── gui.py            # GUI implementation (CTkinter, Matplotlib)
│   ├── data_handler.py   # Data loading, parsing, aggregation
│   └── utils.py          # Utility functions (e.g., path finding)
├── logs/                 # Runtime log files
├── profiles/             # Profiling output files
└── README.md             # This file
```

## Logging

The application uses Python's `logging` module. Log messages (including errors and detailed processing steps) are output to both the console (INFO level) and a file named `data_handler.log` within the `logs/` directory (DEBUG level).

## Profiling

Performance profiling can be enabled/disabled by setting the `PROFILE_ENABLED` flag in `src/main.py`. When enabled, `cProfile` will run, and upon closing the application, raw profiling data (`.prof` file) will be saved in the `profiles/` directory, and a summary will be printed to the logs.